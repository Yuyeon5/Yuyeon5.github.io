<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <style>
    div.container {
      width: 100%;
    }

    nav {
      float: left;
      max-width: 200px;
      margin: 0;
      padding: 1em;
    }

    nav ul {
      list-style-type: none;
      padding: 0;
    }

    nav ul a {
      text-decoration: none;
    }

    article {
      margin-left: 200;
      border-left: 1px solid gray;
      padding: 1em;
      overflow: hidden;
    }

    #canvas {
      background-color: #000;
      margin-left: 200;
      border-left: 1px solid gray;
      padding: 1em;
      overflow: hidden;
    }
  </style>
</head>

<body>
  <div class="container">
    <nav>
      <ul>
        <div id="category_Table_type">
          <table class="category_table">
            <tbody>
              <tr>
                <th>폭(W)</th>
                <td>
                  <select id="selectWidth" onchange="updateScene()">
                    <option value="700">선택</option>
                    <option value="700">W700</option>
                    <option value="1000">W1000</option>
                    <option value="1200">W1200</option>
                    <option value="1400">W1400</option>
                    <option value="1600">W1600</option>
                    <option value="1800">W1800</option>
                    <option value="2000">W2000</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th>깊이(D)</th>
                <td>
                  <select id="selectDepth" onchange="updateScene()">
                    <option value="500">선택</option>
                    <option value="500">D500</option>
                    <option value="600">D600</option>
                    <option value="700">D700</option>
                    <option value="800">D800</option>
                    <option value="900">D900</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th>상판색상</th>
              </tr>
              <tr>
                <th>프레임색상</th>
              </tr>
            </tbody>
          </table>
        </div>
      </ul>
    </nav>
    <div id="canvas">
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/86/three.js"></script>
    <script src="./TrackballControls.js"></script>

    <script>
      var container;
      var camera, controls, scene, renderer;
      var geometry, material;
      var board;
      var frame;

      var board_thickness = 20;
      var frame_thickness = 20;
      var frame_length = 720;

      init();
      animate();

      function init() {
        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 10000);
        camera.position.x = 1000;
        camera.position.y = 500;
        camera.position.z = 3000;

        updateScene();

        // renderer
        renderer = new THREE.WebGLRenderer({ antialias: false });
        renderer.setClearColor(0);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);

        container = document.getElementById('canvas');
        container.appendChild(renderer.domElement);

        controls = new THREE.TrackballControls(camera, renderer.domElement);
        controls.rotateSpeed = 50.0;
        controls.zoomSpeed = 1.2;
        controls.panSpeed = 0.8;
        controls.noZoom = false;
        controls.noPan = false;
        controls.staticMoving = true;
        controls.dynamicDampingFactor = 0.3;

        controls.addEventListener('change', render);

        window.addEventListener('resize', onWindowResize, false);

        render();
      }
      function updateScene() {
        // world
        scene = new THREE.Scene();

        // board
        var width = document.getElementById('selectWidth').value;
        var depth = document.getElementById('selectDepth').value;

        geometry = new THREE.BoxBufferGeometry(width, board_thickness, depth);
        material = new THREE.MeshBasicMaterial();
        board = new THREE.Mesh(geometry, material);
        board.updateMatrix();
        board.matrixAutoUpdate = false;

        // frame
        geometry = new THREE.BoxBufferGeometry(frame_thickness, frame_length, frame_thickness);
        frame = new THREE.Mesh(geometry, material);
        frame.position.x = - (width - frame_thickness) / 2;
        frame.position.y = - frame_length / 2;
        frame.position.z = - (depth - frame_thickness) / 2;
        board.add(frame);

        frame = new THREE.Mesh(geometry, material);
        frame.position.x = (width - frame_thickness) / 2;
        frame.position.y = - frame_length / 2;
        frame.position.z = - (depth - frame_thickness) / 2;
        board.add(frame);

        frame = new THREE.Mesh(geometry, material);
        frame.position.x = - (width - frame_thickness) / 2;
        frame.position.y = - frame_length / 2;
        frame.position.z = (depth - frame_thickness) / 2;
        board.add(frame);

        frame = new THREE.Mesh(geometry, material);
        frame.position.x = (width - frame_thickness) / 2;
        frame.position.y = - frame_length / 2;
        frame.position.z = (depth - frame_thickness) / 2;
        board.add(frame);

        scene.add(board);

        // lights
        light = new THREE.DirectionalLight(0xffffff);
        light.position.set(1, 1, 1);
        scene.add(light);
        light = new THREE.DirectionalLight(0x002288);
        light.position.set(-1, -1, -1);
        scene.add(light);
        light = new THREE.AmbientLight(0x222222);
        scene.add(light);
      }
      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
        controls.handleResize();
        render();
      }
      function animate() {
        requestAnimationFrame(animate);
        controls.update();
      }
      function render() {
        renderer.render(scene, camera);
      }
    </script>
</body>

</html>